/** Convert M3U playlist to HTML (JS) **/
async function M3U_load(n){await fetch(n).then(n=>n.text()).then(n=>{convertPlaylist(n)}).catch(n=>console.error(n))}function insertChannel(n,t,i){const e=document.querySelector(".container-playlist"),r=document.createElement("div"),u=document.createElement("img"),f=document.createElement("span");r.classList.add("content-list");r.setAttribute("data-name",t);r.setAttribute("data-url",i);u.src=n;f.textContent=t;r.appendChild(u);r.appendChild(f);e.appendChild(r)}function convertPlaylist(n){let u=n.split("\n"),t="",i="",r="";for(const n of u){const f=n.match(/#EXTM3U/g),e=n.match(/#KODIPROP/g),o=n.match(/#EXTVLCOPT/g),u=n.replace(n.split(f)[1],"").replace(f,"").replace(n.split(e)[1],"").replace(e,"").replace(n.split(o)[1],"").replace(o,"");if(u.startsWith("#EXTINF")){const n=u.split(/tvg-logo=(?<scope>"[^"]*")/g)[1];t=n.replace(/["]/g,"");const r=u.split(/tvg-id=(?<scope>"[^"]*")/g)[1],f=u.match("tvg-id="),e=u.split(/tvg-name=(?<scope>"[^"]*")/g)[1],o=u.match("tvg-name="),s=u.split(/tvg-logo=(?<scope>"[^"]*")/g)[1],h=u.match("tvg-logo="),c=u.split(/tvg-shift=(?<scope>"[^"]*")/g)[1],l=u.match("tvg-shift="),a=u.split(/group-title=(?<scope>"[^"]*")/g)[1],v=u.match("group-title="),y=u.split(/user-agent=(?<scope>"[^"]*")/g)[1],p=u.match("user-agent="),w=u.split(/ch-number=(?<scope>"[^"]*")/g)[1],b=u.match("ch-number="),k=u.split(/tvg-chno=(?<scope>"[^"]*")/g)[1],d=u.match("tvg-chno="),g=u.replace(r,"").replace(f,"").replace(e,"").replace(o,"").replace(s,"").replace(h,"").replace(c,"").replace(l,"").replace(a,"").replace(v,"").replace(y,"").replace(p,"").replace(w,"").replace(b,"").replace(k,"").replace(d,"").replace("#EXTINF:-1","").replace(/[\s,]/g,"");i=g.replace(/[_]/g," ").replace(/[&]/g," & ").trim().replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1)}).replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z])([A-Z][a-z])/g,"$1 $2").replace("("," (").replace(")",") ").replace("["," [").replace("]","] ")}else u.trim()!==""&&(r=u.trim(),insertChannel(t,i,r))}document.addEventListener("DOMContentLoaded",playlistTrigger())}function playlistTrigger(){const r=document.querySelectorAll(".content-list"),t=document.querySelector(".container-playlist"),u=document.querySelector(".close-player"),i=document.querySelector("#player"),n=videojs("video");for(const f of r){const e=f.getAttribute("data-name"),r=f.getAttribute("data-url");f.style.display=e.match("undefined")||e.match("null")||e===""?"none":"flex";f.style.display=r.match(/https:/g)||r.match(/http:/g)?"flex":e.match("undefined")||e.match("null")||e===""?"none":"none";f.addEventListener("click",n=>{n.preventDefault(),s(),Object.assign(i.style,{display:"flex",visibility:"visible",zIndex:"100"}),t.style.overflow="hidden"});u.addEventListener("click",r=>{r.preventDefault(),n.pause(),Object.assign(i.style,{display:"none",visibility:"hidden",zIndex:"0"}),t.style.overflow="scroll"});function s(){n.src({src:r,type:o()});n.load();n.reloadSourceOnError({getSource:function(n){n({src:r,type:o()})},errorInterval:5});n.hlsQualitySelector()}function o(){return r.match(/.m3u8/g)?"application/x-mpegURL":r.match(/.mpd/g)?"application/dash+xml":r.match(/.mp4/g)?"video/mp4":r.match(/.mkv/g)?"video/webm":r.match(/.mp3/g)?"audio/mpeg":"video/mp4"}const h=document.querySelector("#preloader");f.style.display==="flex"&&Object.assign(h.style,{display:"none",visibility:"hidden",zIndex:"0"})}}
